<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Experi√™ncia Interativa</title>
<style>
body {
  margin:0;
  padding:0;
  background:black;
  color:white;
  font-family:Arial, sans-serif;
  text-align:center;
}
h1 { color: gold; margin-top: 20px; }
.video-wrapper {
  width:100%;
  max-width:500px;
  margin:20px auto;
  overflow:hidden;
  border:2px solid gold;
  border-radius:10px;
}
video {
  width:100%;
  display:block;
  transform-origin:center center;
}
button {
  padding:10px 20px;
  margin:10px;
  font-size:16px;
  background:gold;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
audio { display:none; }
</style>
</head>
<body>

<h1>üé∂ Experi√™ncia Interativa</h1>

<div class="video-wrapper">
  <video id="video" autoplay muted playsinline></video>
</div>

<button id="startBtn">‚ñ∂Ô∏è Gravar + Efeitos</button>

<audio id="bgAudio" src="audio.mp3" loop autoplay></audio>

<script>
let stream, mediaRecorder, recordedChunks = [];
const video = document.getElementById("video");
const audio = document.getElementById("bgAudio");

async function startCamera() {
  stream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode: { exact:"environment" } }, audio:false });
  video.srcObject = stream;
}
startCamera();

document.getElementById("startBtn").addEventListener("click", ()=>{
  recordedChunks = [];
  mediaRecorder = new MediaRecorder(stream);
  mediaRecorder.ondataavailable = e => { if(e.data.size>0) recordedChunks.push(e.data); };

  mediaRecorder.onstop = ()=>{
    const blob = new Blob(recordedChunks,{type:'video/webm'});
    const url = URL.createObjectURL(blob);
    video.srcObject = null;
    video.src = url;
    video.loop = true;
    video.play();

    // Slow/Fast
    video.playbackRate = 0.5;
    setInterval(()=>{ video.playbackRate = video.playbackRate===0.5 ? 2 : 0.5; }, 4000);

    // Zoom org√¢nico
    let scale = 1, dir = 1;
    function zoom(){
      scale += dir*0.0008;
      if(scale>=1.6) dir=-1;
      if(scale<=1) dir=1;
      video.style.transform = `scale(${scale})`;
      if(!video.paused) requestAnimationFrame(zoom);
    }
    zoom();
  };

  mediaRecorder.start();

  // Zoom org√¢nico na c√¢mera enquanto grava
  let scale = 1, dir = 1;
  const zoomInterval = setInterval(()=>{
    scale += dir*0.01;
    if(scale>=1.6) dir=-1;
    if(scale<=1) dir=1;
    video.style.transform = `scale(${scale})`;
  },50);

  // Para grava√ß√£o ap√≥s 10s
  setTimeout(()=>{
    mediaRecorder.stop();
    clearInterval(zoomInterval);
    stream.getTracks().forEach(track=>track.stop());
    video.style.transform = "scale(1)";
  },10000);
});
</script>

</body>
</html>
