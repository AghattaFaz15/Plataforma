<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>üé¨ Hub Grava√ß√£o 360¬∞</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<style>
:root { --azul:#0b132b; --dourado:#d4af37; }
body { font-family: system-ui, sans-serif; text-align:center; background:var(--azul); color:#fff; margin:0; padding:30px; }
h2 { margin:20px 0; }
button { padding:15px 25px; font-size:18px; border:none; border-radius:10px; cursor:pointer; color:#fff; background:var(--dourado); margin:10px; box-shadow:0 6px 16px rgba(0,0,0,.25);}
video { width:100%; max-height:55vh; object-fit:cover; border:3px solid var(--dourado); margin-bottom:15px; }
#status { min-height:48px; margin:12px 0; font-weight:600; }
#qrCode { width:200px; height:200px; margin:20px auto; display:grid; place-items:center; border:2px solid var(--dourado); border-radius:12px; }
</style>
</head>
<body>

<h2>üé¨ Hub Zoom + Slow + QR Code</h2>
<button id="startBtn">‚ñ∂Ô∏è Iniciar Grava√ß√£o</button>
<video id="previewVideo" autoplay playsinline muted></video>
<div id="status">‚è≥ Aguardando...</div>
<div id="qrCode"></div>
<audio id="bgMusic" src="musica.mp3"></audio>

<script>
const startBtn = document.getElementById('startBtn');
const previewVideo = document.getElementById('previewVideo');
const statusDiv = document.getElementById('status');
const qrBox = document.getElementById('qrCode');
const bgMusic = document.getElementById('bgMusic');

let mediaRecorder, chunks = [];
let stream;

// --- QR Code ---
function makeQR(url){
  qrBox.innerHTML = '';
  new QRCode(qrBox, { text: url, width:200, height:200, correctLevel:QRCode.CorrectLevel.H });
}

// --- Inicializa c√¢mera e preview ---
async function initCamera(){
  try{
    stream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode:'environment' }, audio:false });
    previewVideo.srcObject = stream;
  }catch(err){
    alert("Erro ao acessar a c√¢mera: "+err.message);
  }
}

// --- Inicia grava√ß√£o do Zoom ---
function startZoomRecording(){
  chunks = [];
  statusDiv.textContent = "üî¥ Gravando Zoom...";
  bgMusic.play();

  const options = { mimeType:'video/webm;codecs=vp9' };
  mediaRecorder = new MediaRecorder(stream, options);

  mediaRecorder.ondataavailable = e => { if(e.data.size) chunks.push(e.data); };
  mediaRecorder.onstop = () => {
    const blob = new Blob(chunks, { type:'video/webm' });
    const url = URL.createObjectURL(blob);
    statusDiv.innerHTML = `‚úÖ Zoom finalizado!<br><a href="${url}" target="_blank">Abrir v√≠deo</a>`;
    makeQR(url);

    // Ap√≥s zoom, chama slow.html
    setTimeout(() => {
      window.open('slow.html','_blank');
    }, 1500);
  };

  mediaRecorder.start();
  setTimeout(()=>mediaRecorder.stop(), 10000); // grava 10s
}

// --- Bot√£o iniciar ---
startBtn.onclick = async ()=>{
  startBtn.disabled = true;
  await initCamera();
  startZoomRecording();
};
</script>

</body>
</html>
